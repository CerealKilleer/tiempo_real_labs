ax.sh massif.out.<pid>

if [ -z "$1" ]; then
  echo "Uso: $0 archivo_massif.out"
  exit 1
fi

FILE="$1"

TABLE=$(ms_print "$FILE")

# Extraer cabecera (la primera línea donde aparece "n       time")
HEADER=$(echo "$TABLE" | grep -m1 "n       time")

MAX=$(echo "$TABLE" | awk '
  $1 ~ /^[0-9]+$/ {
    val=$3
    gsub(/,/, "", val)   # quitar comas en números grandes
    if (val > max) {
      max=val
      line=$0
    }
  }
  END {print line}
')

echo "Máximo:"
echo "$HEADER"
echo "$MAX"
echo
echo "Uso máximo total de memoria: $(echo "$MAX" | awk "{gsub(/,/, \"\", \$3); print \$3}") bytes"
